Error handling
==============

Error handling
--------------
The channel and technologic blocks feature error handling routines. A distinction must be made between the following areas:

- Error numbers
- External process control error (CSF)
- Process-specific errors
- Invalid signal states
- Mode switchover error
- Errors in channel blocks


Error numbers
-------------

Most blocks have an output parameter ``ErrorNum`` that can be used to output internal error states of the block as error numbers.

With some blocks, input parameters are checked for permissible values. They are therefore only used to prevent the output value from remaining invalid when the input value is once again in the valid range. If an invalid value is detected, and the corresponding output value is held at the last displayed value instead of an invalid value being displayed. If blocks do not have this check, an invalid value can appear at the output. However, a valid value is displayed again at the output as soon as the input values of the block have changed correspondingly.

Any value set over an interconnection or as a result of a parameter assignment that is outside the range of values (e.g. "Not a Number") is not processed by the block algorithm. The last valid value is processed instead.

In addition to the errors stated above, a limit violation is also signaled for example. Each error number is assigned to a specific error.

If there is more than one error, all error numbers have the same priority. The routine always displays the error number of the error most recently detected in a block cycle.


External process control error (CSF)
------------------------------------

An external process control error always lies outside the process - it exists in the form of device or other hardware faults. If, for example, a run-time error occurs at a valve, there is an error or fault in the pneumatic system.

A process control error is output if an external error is set at the input ``CSF``. You can enable this output function, for example, by interconnecting output Bad of the channel block with input ``CSF`` of the technologic block.

The error message "$$BlockComment$$ External error occurred" is output at ``CSF = 1``.

This state is visualized in the group display by an "S" character in the faceplate overview and in the block icon.

With motor, valve and dosing blocks, there is also the possibility that the block switches to error processing. ``Feature`` bit :doc:`../Configurable response using the Feature/18 - Activating error state for external process control error CSF` must be set for this. The device goes into error processing and moves the drive to the neutral position or switches the dosing operation to off for a doser. If the dosing operation is already finished, it remains in the completed state. Resetting the error is described in :doc:`../General information/Resetting the block in case of interlocks or errors`.


External error (FaultExt)
-------------------------

The FaultExt input can be used to pass an external error without the generation of a message. The device goes into error processing and moves the drive to the neutral position or switches the dosing operation to off for a doser. If the dosing operation is already finished, it remains in the completed state. Separate messages can be generated by interconnecting the external error to ExtMsgx messages that can be freely selected. Resetting the error is described in :doc:`../General information/Resetting the block in case of interlocks or errors`.


Process-specific errors
-----------------------

Process-specific errors can have the following causes:

- Runtime monitoring: If the feedback signals do not match the control settings after a selected time has expired, a process-related error is output.
- Feedback monitoring: Refer to the :doc:`../Monitoring functions/Feedbacks/Monitoring the feedbacks` section for more on this.

If the block algorithm detects a monitoring error while monitoring is enabled, the corresponding output parameter is set to 1 in the block. The "$$BlockComment$$ Feedback error xxx" error message is also output, where xxx, for example, stands for the valve.

This state is visualized in the group display by an "S" character in the faceplate overview and in the block icon.

The block must be reset after the monitoring error was cleared and if automatic mode is set.


Invalid input signals
---------------------

This error is output if inconsistencies are detected between associated I/Os. The close and open commands cannot be output simultaneously to the valve, for example.

If the block algorithm detects an invalid combination of input signals, an error number (``ErrorNum``) is output that depends on the block type.

In the case of motors, valves and batches, the faceplates’ standard view will additionally output the text “invalid signal”.


Mode switchover error
---------------------

This error is reported if you change the mode of the block from:

- Manual to automatic mode or
- Local mode to automatic mode

and the previous and target state are **inconsistent** (bumpless switchover). You can only change the block mode if the subsequent state corresponds with the previous state.

Bumpless switchover can be activated / deactivated using the ``Feature`` connection on the :doc:`../Configurable response using the Feature/17 - Enabling bumpless switchover to automatic mode for valves, motors, and dosers` or :doc:`../Configurable response using the Feature/18 - Disabling bumpless switchover to automatic mode for controllers`.

Bumpless switchover from local to automatic mode is undertaken using the ``LocalSetting`` parameter, as described in section :doc:`../Operating modes of the blocks/Local mode`.

In the standard view of the faceplate, the text "Changeover error" is displayed in the event of an unwanted switchover with bumps.

The block retains local mode if the operator changes the mode from local to automatic and the error mentioned above occurs. The block changes to manual mode if the mode is changed from local to automatic over interconnected inputs and the error mentioned above occurs.


Errors in channel blocks
------------------------

The following errors may be displayed by the channel blocks:

- Channel error
- Device or module fault
- Higher-level error
- Invalid measuring range
